<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title> Map Assistant </title>
    <meta name="title" content="Map Assistant">
    <meta name="description" content="Online assistant for map">
    <meta name="keywords" content="x y converter, lat lng converter, coordinate converter, map, map assistant">

    <link rel="icon" type="image/png" href="images/logo.png">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/proj4@2.7.3/dist/proj4.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<div class="container mx-auto p-4">
    <div class="flex justify-center mb-3">
        <img src="images/logo.png" alt="Logo" class="h-20">
    </div>
    <h1 class="text-3xl font-bold text-center mb-2"> Map Assistant </h1>
    <p class="lead mb-4 text-center text-lg font-medium text-gray-700">
        Created by <a href="https://abolfazlmohajeri.ir" target="_blank" class="text-[#1C274C] hover:text-[#1A2035] font-semibold underline"> Abolfazl Mohajeri </a>
    </p>

    <div class="flex justify-center">
        <div class="w-full max-w-3xl">
            <div id="input-error" class="bg-red-100 border-l-4 border-red-500 text-red-700 shadow-md rounded-lg p-4 mb-4" style="display: none;">
                <span class="font-semibold"> Error: </span> Please enter valid coordinates!
            </div>
        </div>
    </div>

    <div class="flex justify-center mb-4">
        <div class="w-full max-w-3xl bg-white p-6 shadow-md rounded-lg">
            <div class="flex items-center space-x-4">
                <div class="flex-3">
                    <label class="block text-lg text-[#1C274C] font-bold mb-2" for="input-coordinates"> Enter Coordinates </label>
                    <input type="text" id="input-coordinates" class="w-full bg-transparent placeholder:text-slate-400 text-slate-700 text-sm border border-slate-200 rounded pl-3 pr-8 py-2 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-400 shadow-sm focus:shadow-md appearance-none" placeholder="3857 X, Y or 4326 Latitude, Longitude">
                </div>

                <div class="flex-2">
                    <div class="w-full max-w-sm min-w-[200px]">
                        <div class="relative">
                            <label class="block text-lg text-[#1C274C] font-bold mb-2" for="projection-selector"> Select Projection </label>
                            <select id="projection-selector"
                                    class="w-full bg-transparent placeholder:text-slate-400 text-slate-700 text-sm border border-slate-200 rounded pl-3 pr-8 py-2 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-400 shadow-sm focus:shadow-md appearance-none cursor-pointer">
                                <option value="EPSG:3857"> EPSG-3857 (Web Mercator) </option>
                                <option value="EPSG:4326"> EPSG-4326 (WGS 84) </option>
                            </select>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor" class="h-5 w-5 ml-1 absolute top-11 right-2.5 text-slate-700">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 15 12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4">
                <h3 class="block text-lg text-[#1C274C] font-bold mb-2"> Valid Input Examples: </h3>
                <p class="mb-3">
                    <strong class="text-[#1C274C]"> EPSG-3857: </strong>
                    <code class="bg-gray-200 px-2 py-1 rounded"> 5714927.050508631, 4259384.060127694 </code>
                </p>
                <p>
                    <strong class="text-[#1C274C]"> EPSG-4326: </strong>
                    <code class="bg-gray-200 px-2 py-1 rounded"> 51.338063171, 35.699738067 </code>
                </p>
            </div>
        </div>
    </div>

    <div class="flex justify-center mb-4">
        <button id="convert-button" class="bg-blue-500 text-white py-2 px-6 rounded-lg">Convert</button>
    </div>

    <div class="flex justify-center mb-4" id="output-section" style="display: none;">
        <div id="output" class="w-full max-w-3xl bg-white p-6 shadow-md rounded-lg">
            <p id="converted-coordinates" class="text-lg text-gray-700"></p>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $('#convert-button').click(function() {
            const inputCoordinates = $('#input-coordinates').val().trim();
            const selectedProjection = $('#projection-selector').val();
            const inputError = $('#input-error');
            const outputSection = $('#output-section');
            const output = $('#converted-coordinates');

            if (inputCoordinates === '') {
                inputError.show();
                return;
            }

            inputError.hide();
            const proj3857 = 'EPSG:3857';
            const proj4326 = 'EPSG:4326';

            let result;

            if (selectedProjection === proj3857) {
                const regex = /^(-?\d+\.\d+),\s*(-?\d+\.\d+)$/;
                const match = inputCoordinates.match(regex);
                if (match) {
                    const x = parseFloat(match[1]);
                    const y = parseFloat(match[2]);
                    result = proj4(proj3857, proj4326, [x, y]);
                    output.html(`<h3 class="text-lg text-[#1C274C] font-bold">Converted to EPSG-4326:</h3>Longitude: ${result[0]}<br>Latitude: ${result[1]}`);
                    outputSection.show();
                    return;
                }
            } else if (selectedProjection === proj4326) {
                const regex = /^(-?\d+\.\d+),\s*(-?\d+\.\d+)$/;
                const match = inputCoordinates.match(regex);
                if (match) {
                    const lng = parseFloat(match[1]); // Longitude first in EPSG:4326
                    const lat = parseFloat(match[2]);
                    result = proj4(proj4326, proj3857, [lng, lat]);
                    output.html(`<h3 class="text-lg text-[#1C274C] font-bold">Converted to EPSG-3857:</h3>X: ${result[0]}, Y: ${result[1]}`);
                    outputSection.show();
                    return;
                }
            }

            inputError.show();
            outputSection.hide();
        });
    });
</script>
</body>
</html>